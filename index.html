<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Galaxia</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#05070d;
  --panel:#0b1224;
  --blue:#2ea0ff;
  --text:#e8f0ff;
}
*{box-sizing:border-box}
body{
  margin:0;
  height:100vh;
  background:radial-gradient(circle at top,#0d1f44,#05070d);
  font-family:Segoe UI,system-ui;
  color:var(--text);
  overflow:hidden;
}

/* overlays */
.overlay{
  position:fixed;
  inset:0;
  background:#02040ae6;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.modal{
  background:var(--panel);
  padding:28px;
  border-radius:20px;
  width:340px;
  text-align:center;
}
.modal input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  margin-top:10px;
}
.modal button{
  width:100%;
  margin-top:12px;
  padding:12px;
  border-radius:14px;
  border:none;
  background:var(--blue);
  color:white;
  cursor:pointer;
}

/* layout */
.app{display:flex;height:100%}
.sidebar{
  width:240px;
  padding:20px;
  background:linear-gradient(180deg,#0b1224,#05070d);
  display:flex;
  flex-direction:column;
  gap:14px;
}
.sidebar button{
  padding:14px;
  border-radius:16px;
  border:none;
  background:#111f3f;
  color:var(--text);
  cursor:pointer;
}
.sidebar button:hover{background:var(--blue)}

.main{flex:1;padding:24px}
.panel{
  display:none;
  height:100%;
  background:var(--panel);
  border-radius:20px;
  padding:20px;
}
.panel.active{display:flex;flex-direction:column}

/* chat */
.chatBox{
  flex:1;
  background:#02040a;
  border-radius:16px;
  padding:14px;
  overflow-y:auto;
}
.msg{
  margin-bottom:8px;
  padding:10px 14px;
  border-radius:14px;
  background:#0b1a36;
}
.msg strong{color:var(--blue)}
.chatInput{
  display:flex;
  gap:10px;
  margin-top:12px;
}
.chatInput input{
  flex:1;
  padding:12px;
  border-radius:12px;
  border:none;
  background:#02040a;
  color:var(--text);
}
.chatInput button{
  padding:12px 18px;
  border-radius:12px;
  border:none;
  background:var(--blue);
  color:white;
}

/* search */
.searchBar{display:flex;gap:10px;margin-bottom:12px}
.searchBar input{
  flex:1;
  padding:12px;
  border-radius:12px;
  border:none;
}
iframe{
  flex:1;
  border:none;
  border-radius:16px;
}
</style>
</head>

<body>

<!-- locks -->
<div id="siteLock" class="overlay">
  <div class="modal">
    <h3>üîí Enter Site Code</h3>
    <input id="siteCode">
    <button onclick="unlockSite()">Unlock</button>
  </div>
</div>

<div id="nameLock" class="overlay" style="display:none">
  <div class="modal">
    <h3>Choose Username</h3>
    <input id="nameInput">
    <button onclick="saveName()">Continue</button>
  </div>
</div>

<div id="premiumLock" class="overlay" style="display:none">
  <div class="modal">
    <h3>Premium Chat</h3>
    <input id="premiumCode">
    <button onclick="unlockPremium()">Unlock</button>
  </div>
</div>

<div class="app">
  <div class="sidebar">
    <button onclick="openPanel('api')">üõ∞ API Chat</button>
    <button onclick="openPremium()">üíé Premium Chat</button>
    <button onclick="openPanel('search')">üîç Search</button>
  </div>

  <div class="main">
    <div id="api" class="panel active">
      <h2>API Chat (Public)</h2>
      <div id="apiBox" class="chatBox"></div>
      <div class="chatInput">
        <input id="apiMsg">
        <button onclick="sendApi()">Send</button>
      </div>
    </div>

    <div id="premium" class="panel">
      <h2>Premium Chat</h2>
      <div id="premiumBox" class="chatBox"></div>
      <div class="chatInput">
        <input id="premiumMsg">
        <button onclick="sendPremium()">Send</button>
      </div>
    </div>

    <div id="search" class="panel">
      <h2>Search</h2>
      <div class="searchBar">
        <input id="searchInput">
        <button onclick="doSearch()">Go</button>
      </div>
      <iframe id="browser"></iframe>
    </div>
  </div>
</div>

<script type="module">
/* Firebase */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig={
  apiKey:"AIzaSyCPLk7btD2izv-d0u8GrlQV2VIwphrSkMU",
  databaseURL:"https://galaxia-chat-servers-2-default-rtdb.firebaseio.com",
  projectId:"galaxia-chat-servers-2"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

/* state */
let username=localStorage.getItem("galaxiaUser");
let premiumUnlocked=false;
const API_URL="https://696fdb3ca06046ce61880d4c.mockapi.io/Galaxia-messages";

/* locks */
window.unlockSite=()=>{
  if(siteCode.value==="2013"){
    siteLock.style.display="none";
    if(!username) nameLock.style.display="flex";
  }
}
window.saveName=()=>{
  if(nameInput.value.trim()){
    username=nameInput.value.trim();
    localStorage.setItem("galaxiaUser",username);
    nameLock.style.display="none";
  }
}
window.openPremium=()=>{
  if(!premiumUnlocked) premiumLock.style.display="flex";
  else openPanel("premium");
}
window.unlockPremium=()=>{
  if(premiumCode.value==="William2013"){
    premiumUnlocked=true;
    premiumLock.style.display="none";
    openPanel("premium");
    listenFirebase();
  }
}

/* panels */
window.openPanel=id=>{
  document.querySelectorAll(".panel").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* search */
window.doSearch=()=>{
  browser.src="https://duckduckgo.com/?q="+encodeURIComponent(searchInput.value);
}

/* API chat */
async function loadApi(){
  const res=await fetch(API_URL);
  const data=await res.json();
  apiBox.innerHTML="";
  data.forEach(m=>{
    const d=document.createElement("div");
    d.className="msg";
    d.innerHTML=`<strong>${m.user}</strong>: ${m.text}`;
    apiBox.appendChild(d);
  });
  apiBox.scrollTop=apiBox.scrollHeight;
}
window.sendApi=async()=>{
  if(!apiMsg.value) return;
  await fetch(API_URL,{
    method:"POST",
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({user:username,text:apiMsg.value})
  });
  apiMsg.value="";
  loadApi();
}
setInterval(loadApi,2000);
loadApi();

/* Firebase premium chat */
function listenFirebase(){
  onChildAdded(ref(db,"premium"),snap=>{
    const m=snap.val();
    const d=document.createElement("div");
    d.className="msg";
    d.innerHTML=`<strong>${m.user}</strong>: ${m.text}`;
    premiumBox.appendChild(d);
    premiumBox.scrollTop=premiumBox.scrollHeight;
  });
}
window.sendPremium=()=>{
  if(premiumMsg.value){
    push(ref(db,"premium"),{user:username,text:premiumMsg.value});
    premiumMsg.value="";
  }
}
</script>

</body>
</html>
