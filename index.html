<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Galaxia</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#05070d;
  --panel:#0b1224;
  --blue:#1e90ff;
  --text:#e6eeff;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,system-ui;
  background:radial-gradient(circle at top,#0b1c3d,#05070d);
  color:var(--text);
  height:100vh;
  overflow:hidden;
}

/* LOCKS */
.overlay{
  position:fixed;
  inset:0;
  background:#02040aee;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:1000;
}
.box{
  background:var(--panel);
  padding:30px;
  border-radius:20px;
  width:320px;
  text-align:center;
}
.box input,.box button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  margin-top:10px;
}
.box button{
  background:var(--blue);
  color:white;
  cursor:pointer;
}

/* LAYOUT */
.app{display:flex;height:100%}
.sidebar{
  width:240px;
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:14px;
  background:linear-gradient(180deg,#0b1224,#05070d);
}
.sidebar button{
  padding:14px;
  border-radius:16px;
  background:#111f3f;
  color:var(--text);
  border:none;
  cursor:pointer;
}
.sidebar button:hover{background:var(--blue)}

.main{
  flex:1;
  padding:24px;
}

.panel{
  background:var(--panel);
  border-radius:20px;
  padding:20px;
  height:100%;
  display:none;
  flex-direction:column;
}
.panel.active{display:flex}

/* CHAT */
.chatBox{
  flex:1;
  background:#02040a;
  border-radius:16px;
  padding:15px;
  overflow-y:auto;
}
.msg{
  background:#0b1224;
  border-radius:12px;
  padding:8px 12px;
  margin-bottom:8px;
}
.chatInput{
  display:flex;
  gap:10px;
  margin-top:12px;
}
.chatInput input{
  flex:1;
  padding:12px;
  border-radius:12px;
  border:none;
  background:#02040a;
  color:var(--text);
}
.chatInput button{
  padding:12px 18px;
  border-radius:12px;
  border:none;
  background:var(--blue);
  color:white;
}

/* SEARCH */
iframe{
  flex:1;
  border:none;
  border-radius:16px;
}
</style>
</head>

<body>

<!-- SITE LOCK -->
<div id="siteLock" class="overlay">
  <div class="box">
    <h3>üîí Enter Site Code</h3>
    <input id="siteCode">
    <button onclick="unlockSite()">Unlock</button>
  </div>
</div>

<!-- USERNAME -->
<div id="nameLock" class="overlay" style="display:none">
  <div class="box">
    <h3>Choose Username</h3>
    <input id="usernameInput">
    <button onclick="saveName()">Continue</button>
  </div>
</div>

<!-- PREMIUM LOCK -->
<div id="premiumLock" class="overlay" style="display:none">
  <div class="box">
    <h3>Premium Chat</h3>
    <input id="premiumCode">
    <button onclick="unlockPremium()">Unlock</button>
  </div>
</div>

<div class="app">
  <div class="sidebar">
    <button onclick="openPanel('public')">üåç Public Chat</button>
    <button onclick="openPremium()">üíé Premium Chat</button>
    <button onclick="openPanel('search')">üîç Search</button>
  </div>

  <div class="main">
    <div id="public" class="panel active">
      <h2>Public Chat</h2>
      <div id="publicBox" class="chatBox"></div>
      <div class="chatInput">
        <input id="publicMsg">
        <button onclick="sendPublic()">Send</button>
      </div>
    </div>

    <div id="premium" class="panel">
      <h2>Premium Chat</h2>
      <div id="premiumBox" class="chatBox"></div>
      <div class="chatInput">
        <input id="premiumMsg">
        <button onclick="sendPremium()">Send</button>
      </div>
    </div>

    <div id="search" class="panel">
      <h2>Search</h2>
      <iframe src="https://duckduckgo.com/?t=h_&ia=web"></iframe>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig={
  apiKey:"AIzaSyCPLk7btD2izv-d0u8GrlQV2VIwphrSkMU",
  databaseURL:"https://galaxia-chat-servers-2-default-rtdb.firebaseio.com",
  projectId:"galaxia-chat-servers-2"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

let username=localStorage.getItem("galaxiaUser");
let premiumUnlocked=false;

/* LOCKS */
window.unlockSite=()=>{
  if(siteCode.value==="2013"){
    siteLock.style.display="none";
    if(!username) nameLock.style.display="flex";
  }
}
window.saveName=()=>{
  if(usernameInput.value.trim()){
    username=usernameInput.value.trim();
    localStorage.setItem("galaxiaUser",username);
    nameLock.style.display="none";
  }
}
window.openPremium=()=>{
  if(!premiumUnlocked){
    premiumLock.style.display="flex";
  }else openPanel("premium");
}
window.unlockPremium=()=>{
  if(premiumCode.value==="William2013"){
    premiumUnlocked=true;
    premiumLock.style.display="none";
    openPanel("premium");
    listen("premium",premiumBox);
  }
}

/* UI */
window.openPanel=id=>{
  document.querySelectorAll(".panel").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* CHAT */
function listen(path,box){
  onChildAdded(ref(db,path),snap=>{
    const d=snap.val();
    const div=document.createElement("div");
    div.className="msg";
    div.textContent=`${d.user}: ${d.text}`;
    box.appendChild(div);
    box.scrollTop=box.scrollHeight;
  });
}
listen("public",publicBox);

window.sendPublic=()=>{
  if(publicMsg.value){
    push(ref(db,"public"),{user:username,text:publicMsg.value});
    publicMsg.value="";
  }
}
window.sendPremium=()=>{
  if(premiumUnlocked && premiumMsg.value){
    push(ref(db,"premium"),{user:username,text:premiumMsg.value});
    premiumMsg.value="";
  }
}
</script>

</body>
</html>
